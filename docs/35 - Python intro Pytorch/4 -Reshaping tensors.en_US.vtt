WEBVTT

00:02.320 --> 00:10.120
In this video, you will learn more about working with PyTorch tensors by reshaping them from one size

00:10.120 --> 00:11.400
to a different size.

00:11.640 --> 00:18.520
Essentially, this means taking all the information inside the tensor and just organizing it into a

00:18.520 --> 00:22.920
different way with all the same elements but different shapes.

00:22.960 --> 00:27.160
Okay, so let's start by looking at W1 again.

00:27.200 --> 00:29.240
Oops, I meant to write W1.

00:30.720 --> 00:37.120
And now I can use a method on this tensor which is the t method.

00:37.120 --> 00:38.280
And what is t stand for.

00:38.280 --> 00:40.480
It stands for transpose.

00:40.520 --> 00:44.160
Transpose means to swap the rows and the columns.

00:44.160 --> 00:49.360
So let me print out w1 and then print out a space in here as well.

00:50.520 --> 00:50.800
Okay.

00:50.840 --> 00:53.320
So here you see the original W1.

00:53.320 --> 00:56.400
Over here it is two rows and three columns.

00:56.400 --> 00:59.320
And here you see the transpose of W1.

00:59.320 --> 01:02.950
And that is two columns and three rows.

01:02.950 --> 01:04.910
So notice the first column.

01:05.070 --> 01:10.670
Nine four becomes the first row in the transposed version of this matrix.

01:10.830 --> 01:19.190
Similarly, the first row in the original matrix is 923, and that becomes the first column in the transpose

01:19.190 --> 01:20.790
matrix 923.

01:20.910 --> 01:23.630
So all the information is still there.

01:23.630 --> 01:29.950
We haven't changed or removed or modified any of the information in the tensor.

01:29.990 --> 01:32.910
All we've done is swap the rows and the columns.

01:34.070 --> 01:35.910
Okay, here is another thing you can do.

01:35.910 --> 01:37.510
This is called flatten.

01:37.630 --> 01:44.710
To flatten a tensor means to spread it out or like to spool it out into one vector.

01:45.350 --> 01:51.710
If you have taken a linear algebra course then the linear algebra term is vectorize.

01:51.710 --> 02:00.110
So we are vectorizing this matrix by just stretching it out, spooling it out into one set of numbers

02:00.110 --> 02:00.750
like this.

02:00.750 --> 02:07.070
So again all the numbers in here in the flattened version are exactly the same as these numbers.

02:07.070 --> 02:07.710
You can see.

02:07.750 --> 02:11.550
Here's the first row, here's the first row, here's the second row.

02:11.670 --> 02:14.190
And now this is just concatenated on.

02:14.390 --> 02:21.150
It doesn't matter how big W1 is when you flatten it, it just becomes one really long string of numbers.

02:21.990 --> 02:28.830
Uh, flattening matrices is something that you do when you're interested in the numerical characteristics

02:28.830 --> 02:32.230
of the data, and you don't care about the organization.

02:32.230 --> 02:33.110
You will see this.

02:33.110 --> 02:38.150
For example, when making histograms we use the flatten method.

02:38.590 --> 02:38.950
Okay.

02:38.990 --> 02:42.990
Another thing we can do or another method is called dot view.

02:43.070 --> 02:44.990
Again let me show you w1.

02:45.790 --> 02:49.950
Now I will write dot view one comma minus one.

02:49.950 --> 02:58.950
And this is not exactly the same as flatten because here let me write this out shape and then shape.

02:58.950 --> 03:01.870
So in both cases they there are six elements.

03:02.300 --> 03:07.460
But here, with that view, I've actually preserved a two dimensional tensor.

03:07.460 --> 03:09.860
So this is of size one by six.

03:10.060 --> 03:11.780
And this one is a vector.

03:11.780 --> 03:16.140
So a one dimensional tensor it's just of size six okay.

03:16.180 --> 03:19.460
So this still has an additional dimension here.

03:19.740 --> 03:21.340
And what is the minus one for.

03:21.380 --> 03:26.860
Let me comment this so we can see the original matrix and comment this.

03:26.860 --> 03:28.420
So we can see the review.

03:28.780 --> 03:37.780
I specified that the new view or the way to reshape this tensor w one is by having one row, and the

03:37.780 --> 03:44.140
minus one means I don't care how many columns it ends up being, just keep making the columns bigger

03:44.140 --> 03:49.500
and bigger until we run out of room, or until you use up all the elements in the matrix.

03:49.500 --> 03:52.620
So for example, you know, I know that this needs to be six.

03:52.620 --> 03:54.380
So that's going to give me the same number.

03:54.380 --> 03:56.020
But maybe I put four here.

03:56.020 --> 04:01.740
And now I'm going to get an error because shape one comma four is invalid.

04:01.740 --> 04:09.050
So basically PyTorch is complaining that there are six elements, but I'm trying to get a one by four

04:09.490 --> 04:11.890
vector, so that just doesn't make sense.

04:11.890 --> 04:12.930
It doesn't fit.

04:13.090 --> 04:15.210
So we can write one comma six.

04:15.250 --> 04:21.290
Now the thing is, if you want to write the exact number of elements, you need to know the exact number

04:21.290 --> 04:22.170
of elements.

04:22.370 --> 04:25.610
Sometimes you don't know that in advance.

04:25.610 --> 04:31.570
Sometimes you actually can calculate it, but it's just an additional calculation with more code that

04:31.570 --> 04:32.530
you don't need.

04:32.690 --> 04:37.450
So that's why you write minus one and you basically say PyTorch.

04:37.490 --> 04:43.410
You figure it out, you calculate how many columns this is going to end up being.

04:44.330 --> 04:44.810
Okay.

04:45.010 --> 04:46.530
We can also reverse this.

04:46.530 --> 04:53.050
And here I'm saying I want one column and however many rows that ends up being.

04:53.170 --> 04:57.170
So that is again all the same information in the tensor.

04:57.370 --> 05:00.770
But now we have however many rows we have.

05:00.810 --> 05:06.040
It turns out to be six rows, However many rows and one column.

05:06.160 --> 05:12.320
Now notice this looks quite different from how it looked before with a row vector.

05:13.120 --> 05:14.840
Okay, so this is a view.

05:14.880 --> 05:17.160
There's another method called reshape.

05:17.200 --> 05:18.960
It does exactly the same thing.

05:19.480 --> 05:25.840
To be honest, I'm not sure off the top of my head why there is two separate methods for view and reshape.

05:25.880 --> 05:32.200
I'm sure there are some subtle differences between them, but in practice you can use them interchangeably.

05:32.720 --> 05:36.840
Okay, so that is for flatten view and reshape.

05:37.080 --> 05:40.080
Let's make some other variables with PyTorch.

05:40.080 --> 05:41.000
So there is.

05:41.000 --> 05:44.200
So you already know about numpy dot arange.

05:44.360 --> 05:47.560
There is also a torch dot arrange.

05:47.560 --> 05:49.160
So torch arrange.

05:49.160 --> 05:51.520
And let's have nine numbers here.

05:51.760 --> 05:58.320
The functionality of torch arrange is exactly the same as the numpy version.

05:58.640 --> 06:02.000
The only difference is that this variable.

06:02.040 --> 06:07.880
The output of this function is of type tensor instead of being of type numpy array.

06:08.280 --> 06:12.520
So let's create a new variable here v dot shape.

06:12.800 --> 06:17.800
So we see it is a one dimensional tensor of shape of size nine.

06:18.800 --> 06:24.120
Now what if we actually needed this to be a two dimensional tensor a matrix.

06:24.320 --> 06:26.360
So that is not possible here.

06:26.360 --> 06:29.600
But we can do something called un squeeze.

06:29.600 --> 06:32.000
So there's another method called unsqueeze.

06:32.480 --> 06:40.080
The zero here is for the dimension unsqueeze means to insert a singleton dimension.

06:40.240 --> 06:42.960
So here you see let me show this.

06:42.960 --> 06:44.720
So print v.

06:45.720 --> 06:49.240
This is all the same numbers in both of these cases.

06:49.240 --> 06:53.000
But when I unsqueeze now you can see there's an extra.

06:53.040 --> 06:54.560
Let me zoom in here.

06:55.080 --> 06:59.480
You can see there is an extra square bracket in here.

06:59.680 --> 07:01.600
And why is there an extra square bracket?

07:01.600 --> 07:04.790
Because now this has another Other dimension.

07:05.550 --> 07:08.590
So let's write dot shape.

07:08.870 --> 07:10.470
And I'll uncomment this.

07:10.470 --> 07:17.710
And now you see this v here the output of torch A range is a nine element vector.

07:17.710 --> 07:19.350
It's a one dimensional tensor.

07:19.670 --> 07:23.830
And here we have a two dimensional tensor still with only nine elements.

07:24.590 --> 07:24.990
Okay.

07:25.030 --> 07:29.150
So v is a vector like this.

07:29.150 --> 07:33.150
We can reshape this reshape to be three by three.

07:33.510 --> 07:35.990
So that gives us a three by three matrix.

07:36.030 --> 07:39.710
Again all the same numbers integers from zero through eight.

07:39.750 --> 07:44.510
But now I have reshaped it into a three by three matrix.

07:44.710 --> 07:49.070
So we can see that is a three by three two dimensional tensor.

07:49.230 --> 07:51.470
I can unsqueeze this again.

07:51.910 --> 07:55.910
And that's going to be a one by three by three tensor.

07:56.230 --> 07:58.670
I can also unsqueeze the first dimension.

07:58.670 --> 08:02.710
And that is going to give me a three by one by three tensor.

08:02.870 --> 08:08.980
So it all gets a little bit confusing, but you will get the hang of it as you keep working through

08:09.660 --> 08:10.580
through PyTorch.

08:10.980 --> 08:17.620
Okay, so here you see this is the first element in the second dimension, the second element in the

08:17.620 --> 08:21.540
second dimension, and the third element in the third dimension.

08:21.700 --> 08:29.820
Again, when I write unsqueeze one, then that inserts a new singleton dimension to give us a three

08:29.860 --> 08:31.260
dimensional tensor.

08:31.940 --> 08:34.660
And this can get, you know, this stuff gets really wacky.

08:34.660 --> 08:38.340
There's one more thing I want to show you in this video here.

08:38.340 --> 08:39.900
So let's write V two.

08:40.340 --> 08:43.020
And this is going to be torturing.

08:43.340 --> 08:45.980
Now I'm going to make this be 18 numbers.

08:46.020 --> 08:46.300
Okay.

08:46.340 --> 08:50.100
So this is integers zero through 17.

08:50.380 --> 08:52.260
So far not so interesting.

08:52.540 --> 08:59.260
But because this is more numbers we can actually reshape this into a multidimensional tensor a three

08:59.300 --> 09:00.460
dimensional tensor.

09:00.660 --> 09:03.380
So let's do two by three by three.

09:03.900 --> 09:07.420
So again this is now a cube of numbers.

09:07.420 --> 09:15.460
You can see all the integers zero through 17, but the organization is that there are two two dimensional

09:15.460 --> 09:16.460
matrices.

09:16.460 --> 09:21.420
So one two dimensional matrix from 0 to 18 sorry to eight.

09:21.460 --> 09:26.540
And then there's another two dimensional matrix that goes from 9 to 17.

09:26.700 --> 09:30.740
So you think about this as being a slice like a slice of bread.

09:31.020 --> 09:32.820
And this is a slice of bread.

09:32.940 --> 09:36.340
And then you can actually put this on top of this one.

09:36.340 --> 09:39.460
And then you get the two slices of bread on top of each other.

09:39.660 --> 09:46.380
I'm sorry to say, there's no peanut butter and jelly in this particular slice in this sandwich, but

09:46.380 --> 09:47.940
that is something you can think about.

09:47.940 --> 09:51.300
So this is one slice of bread, another slice of bread.

09:51.300 --> 09:52.540
And we put them together.

09:52.540 --> 09:55.700
And that gives you a cube of numbers.

09:55.860 --> 09:59.420
And it is of shape two by three by three.

09:59.860 --> 10:00.180
Okay.

10:00.220 --> 10:03.380
So let me print out this.

10:03.420 --> 10:06.050
And then I will print out this.

10:06.450 --> 10:06.770
Okay.

10:06.810 --> 10:08.850
So here we have the shape down here.

10:08.850 --> 10:12.090
And this is the actual three dimensional tensor over here.

10:12.450 --> 10:18.530
What I want to do now this will be the last concept in this video is to introduce you to the function

10:19.010 --> 10:20.250
transpose.

10:20.290 --> 10:21.250
Transpose.

10:21.450 --> 10:26.050
Now this is the same as what I did up here.

10:26.090 --> 10:26.970
Transpose.

10:27.090 --> 10:36.770
This dot little t is a method that is acting on this variable w1, which is an instance of a Python

10:37.130 --> 10:40.650
PyTorch class of type tensor.

10:41.010 --> 10:47.210
And what I have here is the function transpose in the torch library.

10:47.490 --> 10:49.770
So we can transpose v2.

10:50.170 --> 10:52.970
Now actually let me start with transposing.

10:53.490 --> 10:57.010
Where do we have a less interesting one.

10:57.690 --> 10:59.370
Let's go back to V.

10:59.410 --> 11:04.570
Okay I'm going to redefine V to be torch dot.

11:04.610 --> 11:05.330
Arrange dot.

11:05.330 --> 11:13.160
Reshape three by three and then I will print out V and then we can look at its transpose.

11:13.800 --> 11:16.240
Oops I meant to do like this.

11:18.400 --> 11:18.840
Uh, sorry.

11:18.880 --> 11:20.400
This is V like this.

11:20.400 --> 11:21.360
Okay, here we go.

11:21.680 --> 11:26.920
And now actually, let me also put a space in here just so it's a little bit easier to see.

11:28.080 --> 11:32.720
This is the original matrix and this is the transposed matrix.

11:32.720 --> 11:35.600
So you can see all the information is the same.

11:35.600 --> 11:39.440
But the rows here are the columns over here.

11:39.640 --> 11:45.000
And the columns over here in V are now the rows of v transpose.

11:45.400 --> 11:48.360
Now why did I have to write in zero comma one.

11:48.560 --> 11:51.920
These are the two dimensions that I want to transpose.

11:52.400 --> 11:59.360
Now the thing is, in this particular variable there are only two dimensions in the first place right.

11:59.400 --> 12:01.560
So we can say v dot shape.

12:01.960 --> 12:03.280
There's only two dimensions.

12:03.280 --> 12:08.190
So it's necessarily the case that we are going to transpose one for the other.

12:08.390 --> 12:11.390
But we also have this variable v2.

12:11.670 --> 12:15.870
And we know that this is a two by three by three tensor.

12:16.910 --> 12:19.670
So what does it mean to transpose a tensor.

12:20.150 --> 12:24.590
Well the thing about tensors is that you cannot just transpose them.

12:24.590 --> 12:30.790
You need to specify the two dimensions that you want to transpose or that you want to swap.

12:30.950 --> 12:37.350
So when you have a two dimensional tensor or a matrix, the only two dimensions that you can swap are

12:37.350 --> 12:39.670
the rows and the columns, the columns and the rows.

12:39.710 --> 12:40.830
That's all you have.

12:41.270 --> 12:48.750
But when you have a three dimensional tensor, you need to specify which two dimensions you want to

12:48.790 --> 12:50.990
swap, which you want to transpose.

12:51.350 --> 12:51.830
Okay.

12:52.030 --> 12:58.470
So now with V2 we can transpose or swap the first and the second dimensions.

12:58.470 --> 13:02.550
So dimension index zero and dimension index one.

13:02.910 --> 13:07.030
Or we can swap dimension index zero and two.

13:07.550 --> 13:10.510
And let me show you what the shape of this will be.

13:11.670 --> 13:14.550
Actually, let me go back to writing shape like this.

13:14.870 --> 13:15.150
Okay.

13:15.190 --> 13:21.990
So the original, uh, v2 tensor is of shape two by three by three.

13:22.190 --> 13:30.070
But when I swap the first and third dimensions, I get a three by three by two tensor.

13:30.070 --> 13:34.750
Because I have swapped the this dimension with this dimension.

13:35.070 --> 13:42.470
Again, this is equivalent to swapping rows and columns, except we need to specify which dimensions

13:42.470 --> 13:43.830
we are swapping.

13:44.310 --> 13:44.630
Okay.

13:44.670 --> 13:46.950
So I am going to close the video here.

13:46.950 --> 13:54.910
But what I encourage you to do now is play around with this code and make sure you understand how this

13:54.950 --> 14:02.350
information and this information are preserved, but swapped according to whether you write zero comma,

14:02.390 --> 14:06.390
one zero comma 2 or 1 comma two.
