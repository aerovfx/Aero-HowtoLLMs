WEBVTT

00:01.840 --> 00:09.040
From the previous video, you might have gotten the sense that computing derivatives is really easy

00:09.040 --> 00:10.720
and really straightforward.

00:11.200 --> 00:19.000
Well, that kind of is the case for relatively simple functions like polynomials and sine and cosine.

00:19.240 --> 00:25.320
However, when we start getting to more complicated functions and in particular multiplied functions

00:25.320 --> 00:32.600
or embedded functions, things are not so simple anymore, and computing the derivatives of more complicated

00:32.600 --> 00:35.680
functions becomes more complicated.

00:36.160 --> 00:42.920
And so in this video, I'm going to introduce you to two rules in derivatives calculus called the product

00:42.920 --> 00:44.720
rule and the chain rule.

00:45.080 --> 00:47.800
I'll explain how they work in the slides.

00:47.800 --> 00:48.920
And then we'll switch to code.

00:48.920 --> 00:53.240
And I will show you how to implement those two rules in SymPy.

00:53.640 --> 00:58.480
But I want to actually start with kind of the take home message of this video.

00:58.880 --> 01:01.410
So what should you remember from this video.

01:01.730 --> 01:04.090
The main point is that derivatives of.

01:04.250 --> 01:09.930
I call these interacting functions an apology quotes because that's not a formal mathematical term,

01:09.930 --> 01:14.970
but it's basically multiple functions that are interacting with each other through multiplication or

01:14.970 --> 01:15.650
embedding.

01:16.090 --> 01:19.010
Computing the derivatives is unintuitive.

01:19.210 --> 01:24.890
You spend weeks talking about this kind of stuff in a full calculus course.

01:25.090 --> 01:30.570
The point is that computing the derivatives of simple functions is straightforward.

01:30.570 --> 01:36.290
Once you start getting into more complicated things, the derivatives becomes unintuitive and requires

01:36.290 --> 01:37.290
more practice.

01:37.410 --> 01:44.770
However, in the context of deep learning, libraries like PyTorch and also any other library you use,

01:44.810 --> 01:47.490
of course, in this course we're just focusing on PyTorch.

01:47.730 --> 01:54.370
They have built in routines that can estimate very complicated derivatives with high efficiency and

01:54.370 --> 01:55.650
high accuracy.

01:55.810 --> 01:57.170
So that's really the main point.

01:57.170 --> 02:03.550
I want you to appreciate that computing derivatives can be pretty sophisticated and pretty involved,

02:03.790 --> 02:11.150
and also trust that libraries like PyTorch will do this stuff for you very efficiently, very quickly

02:11.150 --> 02:12.510
and very accurately.

02:12.790 --> 02:16.390
Okay, with that said, let's go back and review the Or.

02:16.430 --> 02:20.390
Let me introduce you to the product rule and the chain rule.

02:20.830 --> 02:24.670
So let's imagine we have two functions f of x and g of x.

02:24.950 --> 02:29.590
For simplicity I am just omitting the x in parentheses here.

02:30.070 --> 02:34.470
Now this is not the product rule because we're not multiplying these two functions.

02:34.670 --> 02:40.910
This is just to show you that if you add two functions together and then take their derivative, that

02:40.910 --> 02:47.870
is equivalent of taking the derivative of each function separately and then adding together the derivatives.

02:48.390 --> 02:50.830
Now this seems pretty straightforward.

02:51.230 --> 02:57.870
So you might expect that when you multiply two functions, the derivative of two multiplied functions

02:57.870 --> 03:01.840
would be the derivative of one times the derivative of the other.

03:02.120 --> 03:04.040
Now you know calculus.

03:04.040 --> 03:08.200
University calculus would be much easier if this were really how things worked.

03:08.240 --> 03:10.880
Unfortunately, it is not that simple.

03:10.880 --> 03:14.520
It's also not super complicated, but it's not this intuitive.

03:14.920 --> 03:22.440
Instead, the product rule, the product rule of derivatives is that the derivative of two multiplied

03:22.440 --> 03:29.360
functions is equal to the derivative of the first times the second, plus the first function times the

03:29.360 --> 03:30.880
derivative of the second.

03:31.040 --> 03:32.160
So this function g.

03:32.200 --> 03:32.440
Here.

03:32.440 --> 03:34.160
This is not the derivative of g.

03:34.200 --> 03:36.440
This is the original function g.

03:36.680 --> 03:42.320
So this is the product rule here we're going to see an example of this in Python in a moment.

03:42.320 --> 03:45.160
First I want to introduce you to the chain rule.

03:45.720 --> 03:52.000
The chain rule concerns when you are embedding one function inside of another function.

03:52.280 --> 03:58.560
So here I have a function g of x and it's embedded inside another function f of x.

03:59.240 --> 04:05.380
And here the rule, the chain rule for computing the derivative of this function f of x.

04:05.420 --> 04:06.580
The derivative of x.

04:07.140 --> 04:16.980
The derivative of f with respect to x is the derivative of f with the g function still inside, multiplied

04:16.980 --> 04:22.620
by the derivative of g outside or independent, you know, separated from f.

04:23.060 --> 04:24.940
Now that's a weird string of characters.

04:24.940 --> 04:26.220
Let me show you an example.

04:26.580 --> 04:30.100
Here we have x squared plus four x cubed.

04:30.140 --> 04:34.420
Now this term here this is our g of x.

04:34.940 --> 04:37.980
And then we have this term here with the parenthesis.

04:37.980 --> 04:41.700
And to the power of five that is our f of x.

04:42.020 --> 04:47.540
So you see we have one function of x that's embedded inside another function.

04:47.900 --> 04:51.340
So now we want to compute the derivative with respect to x.

04:51.700 --> 04:58.500
And following this formula following the chain rule that equals the derivative of f with all the g part

04:58.500 --> 04:59.140
inside.

04:59.300 --> 05:03.070
So the derivative of the outside function is five.

05:03.110 --> 05:06.830
We bring down this exponent here and then subtract one.

05:06.830 --> 05:13.990
So five times all of this inside stuff to the power of four times the derivative of the inside stuff,

05:13.990 --> 05:23.070
which is x or two x plus three times four is 12 times x to the power of three minus one which is squared.

05:23.550 --> 05:23.830
Okay.

05:23.870 --> 05:27.390
So you see that the chain rule gets pretty complicated pretty quickly.

05:27.590 --> 05:29.990
Again this is not just some weird made up rule.

05:29.990 --> 05:33.230
There's a very good reason why it has to be like this.

05:33.230 --> 05:37.070
But that's you know, that's a longer topic for a calculus course.

05:37.390 --> 05:40.070
For now, I want to reiterate these two points here.

05:40.070 --> 05:43.670
The derivatives of interacting functions is unintuitive.

05:44.030 --> 05:46.990
And you don't have to worry about that for deep learning.

05:47.110 --> 05:53.390
Libraries like PyTorch will take care of all the low level stuff for you, and you can focus more on

05:53.390 --> 05:58.910
the more important conceptual aspects of the gradient descent algorithm.

05:59.390 --> 06:04.720
So now we're going to switch to Python and I'm going to show you how to implement these things.

06:04.720 --> 06:09.800
And we'll reiterate these two rules using numpy and SymPy.

06:11.240 --> 06:11.680
Okay.

06:11.720 --> 06:14.160
So we import numpy and scipy.

06:14.480 --> 06:17.920
In this case I'm also importing something called IPython.

06:17.920 --> 06:23.480
This is a library about the the notebook itself dot display.

06:24.040 --> 06:28.400
And this is just going to make these equations look a little bit nicer.

06:28.400 --> 06:29.640
You'll see that in a moment.

06:30.240 --> 06:30.520
Okay.

06:30.560 --> 06:35.000
So like in the previous video I create a symbolic variable x.

06:35.240 --> 06:36.840
And here I'm creating two functions.

06:36.840 --> 06:39.360
So f of x and g of x.

06:39.920 --> 06:42.160
Here I'm computing their individual derivatives.

06:42.160 --> 06:46.880
So this is the derivative of x sorry f separate from g.

06:46.920 --> 06:50.160
And this is the derivative of g separate from x.

06:50.640 --> 06:52.880
And then here you see the product rule.

06:53.120 --> 06:58.960
So the derivative of f times g plus f times the derivative of g.

06:59.120 --> 07:00.380
And this is the wrong way.

07:00.380 --> 07:06.500
This is the this is the way you would think it should work, but it's actually not the right way.

07:06.940 --> 07:07.140
Okay.

07:07.180 --> 07:12.940
And then here I'm using SymPy to compute the derivative of f f times g.

07:12.940 --> 07:14.940
So f of x times g of x.

07:15.260 --> 07:15.740
All right.

07:15.740 --> 07:17.300
And then we print out everything.

07:17.780 --> 07:20.620
So here we see the functions.

07:20.940 --> 07:23.460
This was the function F2X squared.

07:24.220 --> 07:25.500
Here we have the function g.

07:25.780 --> 07:31.260
And yeah let's just go up and show you what this special printing library does.

07:31.300 --> 07:33.460
So basically I just imported this display.

07:33.660 --> 07:37.460
And that alone will make the SymPy printing look a little bit nicer.

07:37.460 --> 07:44.980
So instead of saying or instead of printing out two asterisk, asterisk asterisk two, which is it's

07:44.980 --> 07:45.860
kind of ugly.

07:46.100 --> 07:51.420
We get this really nice looking, you know, LaTeX formatted, nice looking equations, what you would

07:51.420 --> 07:52.620
see in a textbook.

07:52.820 --> 07:54.900
So here are the individual functions here.

07:54.900 --> 08:00.630
Their derivatives, if you like, you can pause the video and take a moment to confirm that this really

08:00.630 --> 08:03.990
is the derivative of this and so on for these two.

08:04.550 --> 08:04.790
Okay.

08:04.830 --> 08:09.350
So here was the product rule that I computed manually.

08:09.350 --> 08:10.950
Here it is via SymPy.

08:10.990 --> 08:12.790
You see these two match.

08:12.950 --> 08:14.790
And this is what I called the wrong way.

08:14.790 --> 08:22.590
This was the derivative of x times the derivative of the derivative of f times the derivative of g.

08:23.750 --> 08:28.310
That's very confusing to, you know, all these just individual letters floating around here.

08:28.430 --> 08:31.750
Anyway, now here we are with the chain rule.

08:31.750 --> 08:34.950
So this is the formula that I showed in the slides.

08:34.950 --> 08:38.670
So we have this function here which we can call g.

08:39.230 --> 08:42.630
And then we have this out here which we can call f.

08:43.070 --> 08:46.150
So in fact maybe I will even rewrite this to make this a little bit clearer.

08:46.150 --> 08:50.910
So I'm going to write g of x equals this stuff.

08:50.910 --> 08:55.950
And then f of x equals g of x to the power of five.

08:56.470 --> 08:58.270
So we have an embedded function.

08:58.270 --> 09:03.370
We need to apply the chain rule and we see its derivative.

09:03.410 --> 09:07.210
Now you can go back to the video and confirm that these are the same.

09:07.210 --> 09:14.210
It looks slightly different initially because in the slides I took the five I left the five as a multiplicative

09:14.210 --> 09:15.330
factor here.

09:15.490 --> 09:18.450
And sympy actually multiplied through by five.

09:18.450 --> 09:21.410
So I had 12 x squared.

09:21.410 --> 09:23.010
And this was two x.

09:23.010 --> 09:28.690
And then sympy just multiplied the five through to give us 60 x squared and ten x.

09:29.730 --> 09:35.770
So in this video I introduce you to two additional rules for computing the derivative.

09:35.970 --> 09:43.330
In fact we are going to use the chain rule for computing or implementing gradient descent in deep learning.

09:43.650 --> 09:51.290
And now that you have an intuitive grasp on the derivative, it's time to move on to the next section

09:51.290 --> 09:57.930
of the course where we really start getting into the math and the mechanisms underlying deep learning.
